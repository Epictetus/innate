<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Module: Innate::View</title>
  </head>
  <body>
    <div id="content">
      <div class="section module Innate_View">
  <h1 class="title">Module: Innate::View</h1>
  <div class="section docstring">
  <p>
This is a container module for wrappers of templating engines and handles
lazy requiring of needed engines.
</p>

</div><div class="section constants">
  
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#auto_register-instance_method" title="#auto_register">#auto_register</a></span><span class='args'>(name, *exts)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Combine Kernel#autoload and Innate::View::register.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#get-instance_method" title="#get">#get</a></span><span class='args'>(engine_or_ext)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Try to obtain given engine by its registered name.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#obtain-instance_method" title="#obtain">#obtain</a></span><span class='args'>(klass)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
We need to put this in a Mutex because simultanous calls for the same class
will cause race conditions and one call may return the wrong class on the
first request (before TEMP is set).
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        <span class='name'><a href="#register-instance_method" title="#register">#register</a></span><span class='args'>(klass, *exts)</span>
        <span class='block'></span>
        
      </th>
      <td class="docstring">
        <p>
Register given templating engine wrapper and extensions for later usage.
</p>

        
      </td>
    </tr>
  
</table>
  </div>
<div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>auto_register</h3>
</div><div id="auto_register-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>auto_register</span><span class='args'>(name, *exts)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Combine Kernel#autoload and Innate::View::register
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


58
59
60
61</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/innate/view.rb', line 58</span>

<span class='def def kw'>def</span> <span class='auto_register identifier id'>auto_register</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='exts identifier id'>exts</span><span class='rparen token'>)</span>
  <span class='autoload identifier id'>autoload</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='dstring node'>&quot;innate/view/#{name}&quot;</span><span class='dot token'>.</span><span class='downcase identifier id'>downcase</span><span class='rparen token'>)</span>
  <span class='register identifier id'>register</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{self}::#{name}&quot;</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='exts identifier id'>exts</span><span class='rparen token'>)</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>get</h3>
</div><div id="get-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>get</span><span class='args'>(engine_or_ext)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Try to obtain given engine by its registered name.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


13
14
15
16
17
18
19
20
21
22
23
24</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/innate/view.rb', line 13</span>

<span class='def def kw'>def</span> <span class='get identifier id'>get</span><span class='lparen token'>(</span><span class='engine_or_ext identifier id'>engine_or_ext</span><span class='rparen token'>)</span>
  <span class='return return kw'>return</span> <span class='unless unless_mod kw'>unless</span> <span class='engine_or_ext identifier id'>engine_or_ext</span>
  <span class='eoe identifier id'>eoe</span> <span class='assign token'>=</span> <span class='Array constant id'>Array</span><span class='lbrack token'>[</span><span class='mult op'>*</span><span class='engine_or_ext identifier id'>engine_or_ext</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='first identifier id'>first</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>

  <span class='if if kw'>if</span> <span class='klass identifier id'>klass</span> <span class='assign token'>=</span> <span class='TEMP constant id'>TEMP</span><span class='lbrack token'>[</span><span class='eoe identifier id'>eoe</span><span class='rbrack token'>]</span>
    <span class='return return kw'>return</span> <span class='klass identifier id'>klass</span>
  <span class='elsif elsif kw'>elsif</span> <span class='klass identifier id'>klass</span> <span class='assign token'>=</span> <span class='ENGINE constant id'>ENGINE</span><span class='lbrack token'>[</span><span class='eoe identifier id'>eoe</span><span class='rbrack token'>]</span>
    <span class='TEMP constant id'>TEMP</span><span class='lbrack token'>[</span><span class='eoe identifier id'>eoe</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='obtain identifier id'>obtain</span><span class='lparen token'>(</span><span class='klass identifier id'>klass</span><span class='rparen token'>)</span>
  <span class='else else kw'>else</span>
    <span class='TEMP constant id'>TEMP</span><span class='lbrack token'>[</span><span class='eoe identifier id'>eoe</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='const_get identifier id'>const_get</span><span class='lparen token'>(</span><span class='eoe identifier id'>eoe</span><span class='dot token'>.</span><span class='capitalize identifier id'>capitalize</span><span class='rparen token'>)</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>obtain</h3>
</div><div id="obtain-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>obtain</span><span class='args'>(klass)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
We need to put this in a Mutex because simultanous calls for the same class
will cause race conditions and one call may return the wrong class on the
first request (before TEMP is set). No mutex is used in Fiber environment,
see Innate::State and subclasses.
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


31
32
33
34
35
36
37</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/innate/view.rb', line 31</span>

<span class='def def kw'>def</span> <span class='obtain identifier id'>obtain</span><span class='lparen token'>(</span><span class='klass identifier id'>klass</span><span class='rparen token'>)</span>
  <span class='STATE constant id'>STATE</span><span class='dot token'>.</span><span class='sync identifier id'>sync</span> <span class='do do kw'>do</span>
    <span class='obj identifier id'>obj</span> <span class='assign token'>=</span> <span class='Object constant id'>Object</span>
    <span class='klass identifier id'>klass</span><span class='dot token'>.</span><span class='split identifier id'>split</span><span class='lparen token'>(</span><span class='string val'>'::'</span><span class='rparen token'>)</span><span class='dot token'>.</span><span class='each identifier id'>each</span><span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='e identifier id'>e</span><span class='bitor op'>|</span> <span class='obj identifier id'>obj</span> <span class='assign token'>=</span> <span class='obj identifier id'>obj</span><span class='dot token'>.</span><span class='const_get identifier id'>const_get</span><span class='lparen token'>(</span><span class='e identifier id'>e</span><span class='rparen token'>)</span> <span class='rbrace token'>}</span>
    <span class='obj identifier id'>obj</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>register</h3>
</div><div id="register-instance_method" class="section method">
  <div class="details_title">
  <div class='section methodsignature'>
  <tt class='def'>
    <span class='visibility'>public</span>
    <span class='return_types'></span>
    <span class='name'>register</span><span class='args'>(klass, *exts)</span>
    <span class='block'></span>
  </tt>
</div>

</div><div class="section docstring">
  <p>
Register given templating engine wrapper and extensions for later usage.
</p>
<p>
<tt>name</tt> : the class name of the templating engine wrapper
<tt>exts</tt> : any number of arguments will be turned into strings via
#to_s
</p>
<pre class="code">
         <span class='that identifier id'>that</span> <span class='indicate identifier id'>indicate</span> <span class='which identifier id'>which</span> <span class='filename identifier id'>filename</span><span class='minus op'>-</span><span class='extensions identifier id'>extensions</span> <span class='the identifier id'>the</span> <span class='templates identifier id'>templates</span> <span class='may identifier id'>may</span> <span class='have identifier id'>have</span><span class='dot token'>.</span>
</pre>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


45
46
47
48
49
50
51
52
53
54</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/innate/view.rb', line 45</span>

<span class='def def kw'>def</span> <span class='register identifier id'>register</span><span class='lparen token'>(</span><span class='klass identifier id'>klass</span><span class='comma token'>,</span> <span class='mult op'>*</span><span class='exts identifier id'>exts</span><span class='rparen token'>)</span>
  <span class='exts identifier id'>exts</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='ext identifier id'>ext</span><span class='bitor op'>|</span>
    <span class='ext identifier id'>ext</span> <span class='assign token'>=</span> <span class='ext identifier id'>ext</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span>
    <span class='if if kw'>if</span> <span class='k identifier id'>k</span> <span class='assign token'>=</span> <span class='ENGINE constant id'>ENGINE</span><span class='lbrack token'>[</span><span class='ext identifier id'>ext</span><span class='rbrack token'>]</span>
      <span class='Log constant id'>Log</span><span class='dot token'>.</span><span class='warn identifier id'>warn</span> <span class='dstring node'>&quot;#{ext} is assigned to #{k} already&quot;</span>
    <span class='else else kw'>else</span>
      <span class='ENGINE constant id'>ENGINE</span><span class='lbrack token'>[</span><span class='ext identifier id'>ext</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='klass identifier id'>klass</span>
    <span class='end end kw'>end</span>
  <span class='end end kw'>end</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
  </body>
</html>